========================================
Job ID: 13239926
Node: a100-4040
Starting at: Sat Nov 22 20:31:22 EST 2025
Model: vit_small
========================================
Python: /gpfs/data/shenlab/aj4718/miniconda3/envs/ijepa/bin/python
Python version: Python 3.10.19
PyTorch version: 2.0.0+cu118
CUDA available: True
GPU: 
========================================
Using ViT-Small configuration (~27M parameters)
Starting I-JEPA pretraining with config: configs/hf_vits16_ep300.yaml
Using single GPU (cuda:0)
---
INFO:root:called-params configs/hf_vits16_ep300.yaml
INFO:root:loaded params...
{   'data': {   'batch_size': 64,
                'color_jitter_strength': 0.0,
                'crop_scale': [0.3, 1.0],
                'crop_size': 224,
                'dataset_name': 'tsbpp/fall2025_deeplearning',
                'dataset_type': 'huggingface',
                'num_workers': 8,
                'pin_mem': True,
                'use_color_distortion': False,
                'use_gaussian_blur': False,
                'use_horizontal_flip': False},
    'logging': {   'folder': '/gpfs/data/shenlab/aj4718/ijepa/logs/hf_vits16_bs64_ep300/',
                   'write_tag': 'jepa'},
    'mask': {   'allow_overlap': False,
                'aspect_ratio': [0.75, 1.5],
                'enc_mask_scale': [0.85, 1.0],
                'min_keep': 10,
                'num_enc_masks': 1,
                'num_pred_masks': 4,
                'patch_size': 16,
                'pred_mask_scale': [0.15, 0.2]},
    'meta': {   'copy_data': False,
                'load_checkpoint': False,
                'model_name': 'vit_small',
                'pred_depth': 6,
                'pred_emb_dim': 192,
                'read_checkpoint': None,
                'use_bfloat16': True},
    'optimization': {   'ema': [0.996, 1.0],
                        'epochs': 300,
                        'final_lr': 1e-06,
                        'final_weight_decay': 0.4,
                        'ipe_scale': 1.0,
                        'lr': 0.0005,
                        'start_lr': 0.0001,
                        'warmup': 40,
                        'weight_decay': 0.04}}
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 0
INFO:torch.distributed.distributed_c10d:Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
INFO:root:Running... (rank: 0/1)
INFO:root:Initialized (rank/world-size) 0/1
INFO:root:VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 384, kernel_size=(16, 16), stride=(16, 16))
  )
  (blocks): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=384, out_features=1152, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
)
INFO:root:making imagenet data transforms
INFO:root:Using HuggingFace dataset: tsbpp/fall2025_deeplearning
INFO:root:Loading HuggingFace dataset: tsbpp/fall2025_deeplearning, split: train
ERROR:datasets.load:`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'tsbpp/fall2025_deeplearning' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
INFO:root:Loaded 500000 samples from tsbpp/fall2025_deeplearning
INFO:root:Dataset columns: ['image']
INFO:root:HuggingFace dataset created: tsbpp/fall2025_deeplearning (500000 samples)
INFO:root:HuggingFace data loader created
INFO:root:Using AdamW
INFO:root:Epoch 1
---
Training complete!
========================================
Finished at: Sat Nov 22 20:33:26 EST 2025
========================================
