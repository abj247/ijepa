data:
  batch_size: 64
  color_jitter_strength: 0.0
  crop_scale:
  - 0.3
  - 1.0
  crop_size: 96  # Updated to match dataset
  dataset_name: tsbpp/fall2025_deeplearning
  dataset_type: huggingface
  num_workers: 8
  pin_mem: true
  use_color_distortion: false
  use_gaussian_blur: false
  use_horizontal_flip: false
logging:
  folder: /gpfs/data/shenlab/aj4718/ijepa/logs/scale_ijepa_vits8_bs64_ep300/
  write_tag: scale_jepa_vits8
mask:
  allow_overlap: false
  aspect_ratio:
  - 0.75
  - 1.5
  enc_mask_scale:
  - 0.85
  - 1.0
  min_keep: 10
  num_enc_masks: 1
  num_pred_masks: 4
  patch_size: 8  # CRITICAL UPDATE: Reduced to 8 for 96x96 images
  pred_mask_scale:
  - 0.15
  - 0.2
meta:
  copy_data: false
  load_checkpoint: false
  model_name: vit_small
  pred_depth: 6
  pred_emb_dim: 192
  read_checkpoint: null
  use_bfloat16: true
optimization:
  ema:
  - 0.996
  - 1.0
  epochs: 300
  final_lr: 1.0e-06
  final_weight_decay: 0.4
  ipe_scale: 1.0
  lr: 0.0005
  start_lr: 0.0001
  warmup: 40
  weight_decay: 0.04
  optimizer: adamw # [NEW] Use LARS optimizer
  # [NEW] Auxiliary Loss Configuration
  aux_loss:
    name: "inter_scale_contrastive" # Options: inter_scale_contrastive, hierarchical_consistency, orthogonal_scale
    weight: 0.1 # Lambda
    margin: 1.0 # For contrastive loss
